<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>  
    <class name="org.LexGrid.commonTypes.Property" table="codingSchemeProp" polymorphism="implicit" discriminator-value="property"
    	entity-name="org.LexGrid.commonTypes.Property$CodingScheme">
    	
    	<cache usage="read-write"/>
    
        <composite-id class="org.LexGrid.LexBIG.caCore.hibernate.compositeKeys.CodingSchemePropKey">
        	<key-property name="codingSchemeName"/>
        	<key-property name="propertyId"/>     
        </composite-id>
    
    <discriminator column="propertyType"/>	
    
        <!-- Versionable -->
		<property name="_status" access="field" lazy="true">
			<formula>(select @PREFIX@entryState.status from @PREFIX@entryState where
			 @PREFIX@entryState.entryStateId = entryStateId)</formula>
		</property>
		
		<property name="_effectiveDate" type="date" access="field" lazy="true">
			<formula>(select @PREFIX@entryState.effectiveDate from @PREFIX@entryState where
			 @PREFIX@entryState.entryStateId = entryStateId)</formula>
		</property>
		
		<property name="_expirationDate" type="date" access="field" lazy="true">
			<formula>(select @PREFIX@entryState.expirationDate from @PREFIX@entryState where
			 @PREFIX@entryState.entryStateId = entryStateId)</formula>
		</property>
		
		<many-to-one name="_owner" access="field" not-found="ignore"
			class="org.LexGrid.commonTypes.Source$EntryState">
			<formula>entryStateId</formula>
		</many-to-one>
		 
		<many-to-one name="_entryState" access="field" not-found="ignore"
			class="org.LexGrid.versions.EntryState">
			<formula>entryStateId</formula>
		</many-to-one>	
	
	<!-- Property -->
	<property name="_propertyName" access="field" type="string" column="propertyName" />  
	<property name="_propertyId" insert="false" update="false" access="field" type="string" column="propertyId" />   
	<property name="_propertyType" insert="false" update="false" access="field" formula="'codingScheme'" />
    <property name="_language" access="field" column="language" />   	
    <property name="_isActive" type="boolean" insert="false" update="false" access="field" formula="'1'" />
 
      <bag name="_sourceList" access="field" table="codingSchemePropMultiAttrib" lazy="false" where="typeName = 'source'">  
			 <key>	
			 	<column name="codingSchemeName"/>       	
        		<column name="propertyId"/> 
			 </key>
			<many-to-many class="org.LexGrid.commonTypes.Source$CodingScheme">
				<formula>codingSchemeName</formula>	
				<formula>propertyId</formula>	
				<formula>typeName</formula>
				<formula>attributeValue</formula>						
			</many-to-many>			
		</bag> 
		
		<bag name="_usageContextList" access="field" table="codingSchemePropMultiAttrib" lazy="false" where="typeName = 'usageContext'">  
			 <key>	
			 	<column name="codingSchemeName"/>       		
        		<column name="propertyId"/> 
			 </key>
			<element type="string" column="attributeValue"/>
		</bag> 
		
		   <bag name="_propertyQualifierList" access="field" table="codingSchemePropMultiAttrib" lazy="false" where="typeName = 'qualifier'">  
			 <key>	
			 	<column name="codingSchemeName"/>
        		<column name="propertyId"/> 
			 </key>
			<many-to-many class="org.LexGrid.commonTypes.PropertyQualifier$CodingScheme">
				<formula>codingSchemeName</formula>					
				<formula>propertyId</formula>	
				<formula>typeName</formula>		
				<formula>attributeValue</formula>									
			</many-to-many>			
		</bag> 	
		
	   <one-to-one name="_value" access="field" class="org.LexGrid.commonTypes.Text$CodingSchemeEntityProperty">
       		<formula>codingSchemeName</formula>
      		<formula>propertyId</formula>    
       </one-to-one>
		
    </class>
    
      <class name="org.LexGrid.commonTypes.Text" table="codingSchemeProp" 
    	entity-name="org.LexGrid.commonTypes.Text$CodingSchemeEntityProperty">
    	
    	<cache usage="read-write"/>
    	
        <composite-id class="org.LexGrid.LexBIG.caCore.hibernate.compositeKeys.CodingSchemePropKey">
        	<key-property name="codingSchemeName"/>
        	<key-property name="propertyId"/>    
        </composite-id> 
        <property name="_content" access="field" update="false" insert="false" column="propertyValue"/>  
    </class>
  
</hibernate-mapping>

